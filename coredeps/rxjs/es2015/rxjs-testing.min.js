/* rxjs@6.6.3 */
System.register(["./rxjs-shared.min.js","./rxjs-shared.min3.js","./rxjs-shared.min8.js","./rxjs-shared.min5.js"],(function(e){"use strict";var s,r,t,a,i,n,c;return{setters:[function(e){s=e.O,r=e.S},function(e){t=e.S,a=e.N,i=e.a},function(){},function(e){n=e.V,c=e.a}],execute:function(){class o{constructor(e,s=Number.POSITIVE_INFINITY){this.subscribedFrame=e,this.unsubscribedFrame=s}}class h{constructor(){this.subscriptions=[]}logSubscribedFrame(){return this.subscriptions.push(new o(this.scheduler.now())),this.subscriptions.length-1}logUnsubscribedFrame(e){const s=this.subscriptions,r=s[e];s[e]=new o(r.subscribedFrame,this.scheduler.now())}}function u(e,s){for(let r=0,t=s.length;r<t;r++){const t=s[r],a=Object.getOwnPropertyNames(t.prototype);for(let s=0,r=a.length;s<r;s++){const r=a[s];e.prototype[r]=t.prototype[r]}}}class b extends s{constructor(e,s){super((function(e){const s=this,t=s.logSubscribedFrame(),a=new r;return a.add(new r(()=>{s.logUnsubscribedFrame(t)})),s.scheduleMessages(e),a})),this.messages=e,this.subscriptions=[],this.scheduler=s}scheduleMessages(e){const s=this.messages.length;for(let r=0;r<s;r++){const s=this.messages[r];e.add(this.scheduler.schedule(({message:e,subscriber:s})=>{e.notification.observe(s)},s.frame,{message:s,subscriber:e}))}}}u(b,[h]);class l extends t{constructor(e,s){super(),this.messages=e,this.subscriptions=[],this.scheduler=s}_subscribe(e){const s=this,t=s.logSubscribedFrame(),a=new r;return a.add(new r(()=>{s.logUnsubscribedFrame(t)})),a.add(super._subscribe(e)),a}setup(){const e=this,s=e.messages.length;for(var r=0;r<s;r++)(()=>{var s=e.messages[r];e.scheduler.schedule(()=>{s.notification.observe(e)},s.frame)})()}}u(l,[h]);class m extends n{constructor(e){super(c,750),this.assertDeepEqual=e,this.hotObservables=[],this.coldObservables=[],this.flushTests=[],this.runMode=!1}createTime(e){const s=e.indexOf("|");if(-1===s)throw new Error('marble diagram for time should have a completion marker "|"');return s*m.frameTimeFactor}createColdObservable(e,s,r){if(-1!==e.indexOf("^"))throw new Error('cold observable cannot have subscription offset "^"');if(-1!==e.indexOf("!"))throw new Error('cold observable cannot have unsubscription marker "!"');const t=m.parseMarbles(e,s,r,void 0,this.runMode),a=new b(t,this);return this.coldObservables.push(a),a}createHotObservable(e,s,r){if(-1!==e.indexOf("!"))throw new Error('hot observable cannot have unsubscription marker "!"');const t=m.parseMarbles(e,s,r,void 0,this.runMode),a=new l(t,this);return this.hotObservables.push(a),a}materializeInnerObservable(e,s){const r=[];return e.subscribe(e=>{r.push({frame:this.frame-s,notification:a.createNext(e)})},e=>{r.push({frame:this.frame-s,notification:a.createError(e)})},()=>{r.push({frame:this.frame-s,notification:a.createComplete()})}),r}expectObservable(e,r=null){const t=[],i={actual:t,ready:!1},n=m.parseMarblesAsSubscriptions(r,this.runMode),c=n.subscribedFrame===Number.POSITIVE_INFINITY?0:n.subscribedFrame,o=n.unsubscribedFrame;let h;this.schedule(()=>{h=e.subscribe(e=>{let r=e;e instanceof s&&(r=this.materializeInnerObservable(r,this.frame)),t.push({frame:this.frame,notification:a.createNext(r)})},e=>{t.push({frame:this.frame,notification:a.createError(e)})},()=>{t.push({frame:this.frame,notification:a.createComplete()})})},c),o!==Number.POSITIVE_INFINITY&&this.schedule(()=>h.unsubscribe(),o),this.flushTests.push(i);const{runMode:u}=this;return{toBe(e,s,r){i.ready=!0,i.expected=m.parseMarbles(e,s,r,!0,u)}}}expectSubscriptions(e){const s={actual:e,ready:!1};this.flushTests.push(s);const{runMode:r}=this;return{toBe(e){const t="string"==typeof e?[e]:e;s.ready=!0,s.expected=t.map(e=>m.parseMarblesAsSubscriptions(e,r))}}}flush(){const e=this.hotObservables;for(;e.length>0;)e.shift().setup();super.flush(),this.flushTests=this.flushTests.filter(e=>!e.ready||(this.assertDeepEqual(e.actual,e.expected),!1))}static parseMarblesAsSubscriptions(e,s=!1){if("string"!=typeof e)return new o(Number.POSITIVE_INFINITY);const r=e.length;let t=-1,a=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,n=0;for(let c=0;c<r;c++){let r=n;const o=e=>{r+=e*this.frameTimeFactor},h=e[c];switch(h){case" ":s||o(1);break;case"-":o(1);break;case"(":t=n,o(1);break;case")":t=-1,o(1);break;case"^":if(a!==Number.POSITIVE_INFINITY)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");a=t>-1?t:n,o(1);break;case"!":if(i!==Number.POSITIVE_INFINITY)throw new Error("found a second subscription point '^' in a subscription marble diagram. There can only be one.");i=t>-1?t:n;break;default:if(s&&h.match(/^[0-9]$/)&&(0===c||" "===e[c-1])){const s=e.slice(c).match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(s){c+=s[0].length-1;const e=parseFloat(s[1]);let r;switch(s[2]){case"ms":r=e;break;case"s":r=1e3*e;break;case"m":r=1e3*e*60}o(r/this.frameTimeFactor);break}}throw new Error("there can only be '^' and '!' markers in a subscription marble diagram. Found instead '"+h+"'.")}n=r}return i<0?new o(a):new o(a,i)}static parseMarbles(e,s,r,t=!1,i=!1){if(-1!==e.indexOf("!"))throw new Error('conventional marble diagrams cannot have the unsubscription marker "!"');const n=e.length,c=[],o=i?e.replace(/^[ ]+/,"").indexOf("^"):e.indexOf("^");let h=-1===o?0:o*-this.frameTimeFactor;const u="object"!=typeof s?e=>e:e=>t&&s[e]instanceof b?s[e].messages:s[e];let l=-1;for(let s=0;s<n;s++){let t=h;const n=e=>{t+=e*this.frameTimeFactor};let o;const b=e[s];switch(b){case" ":i||n(1);break;case"-":n(1);break;case"(":l=h,n(1);break;case")":l=-1,n(1);break;case"|":o=a.createComplete(),n(1);break;case"^":n(1);break;case"#":o=a.createError(r||"error"),n(1);break;default:if(i&&b.match(/^[0-9]$/)&&(0===s||" "===e[s-1])){const r=e.slice(s).match(/^([0-9]+(?:\.[0-9]+)?)(ms|s|m) /);if(r){s+=r[0].length-1;const e=parseFloat(r[1]);let t;switch(r[2]){case"ms":t=e;break;case"s":t=1e3*e;break;case"m":t=1e3*e*60}n(t/this.frameTimeFactor);break}}o=a.createNext(u(b)),n(1)}o&&c.push({frame:l>-1?l:h,notification:o}),h=t}return c}run(e){const s=m.frameTimeFactor,r=this.maxFrames;m.frameTimeFactor=1,this.maxFrames=Number.POSITIVE_INFINITY,this.runMode=!0,i.delegate=this;const t={cold:this.createColdObservable.bind(this),hot:this.createHotObservable.bind(this),flush:this.flush.bind(this),expectObservable:this.expectObservable.bind(this),expectSubscriptions:this.expectSubscriptions.bind(this)};try{const a=e(t);return this.flush(),a}finally{m.frameTimeFactor=s,this.maxFrames=r,this.runMode=!1,i.delegate=void 0}}}e("TestScheduler",m)}}}));
