/* rxjs@6.6.3 */
System.register(["./rxjs-shared.min.js","./rxjs-shared.min3.js","./rxjs-shared.min4.js","./rxjs-shared.min8.js"],(function(t){"use strict";var e,s,r,o,n,i;return{setters:[function(t){e=t.O,s=t.e,r=t.S},function(t){o=t.h,n=t.S},function(t){i=t.R},function(){}],execute:function(){t("webSocket",(function(t){return new a(t)}));const c={url:"",deserializer:t=>JSON.parse(t.data),serializer:t=>JSON.stringify(t)};class a extends o{constructor(t,s){if(super(),t instanceof e)this.destination=s,this.source=t;else{const e=this._config=Object.assign({},c);if(this._output=new n,"string"==typeof t)e.url=t;else for(let s in t)t.hasOwnProperty(s)&&(e[s]=t[s]);if(!e.WebSocketCtor&&WebSocket)e.WebSocketCtor=WebSocket;else if(!e.WebSocketCtor)throw new Error("no WebSocket constructor can be found");this.destination=new i}}lift(t){const e=new a(this._config,this.destination);return e.operator=t,e.source=this,e}_resetState(){this._socket=null,this.source||(this.destination=new i),this._output=new n}multiplex(t,s,r){const o=this;return new e(e=>{try{o.next(t())}catch(t){e.error(t)}const n=o.subscribe(t=>{try{r(t)&&e.next(t)}catch(t){e.error(t)}},t=>e.error(t),()=>e.complete());return()=>{try{o.next(s())}catch(t){e.error(t)}n.unsubscribe()}})}_connectSocket(){const{WebSocketCtor:t,protocol:e,url:o,binaryType:n}=this._config,c=this._output;let a=null;try{a=e?new t(o,e):new t(o),this._socket=a,n&&(this._socket.binaryType=n)}catch(t){return void c.error(t)}const h=new r(()=>{this._socket=null,a&&1===a.readyState&&a.close()});a.onopen=t=>{const{_socket:e}=this;if(!e)return a.close(),void this._resetState();const{openObserver:r}=this._config;r&&r.next(t);const o=this.destination;this.destination=s.create(t=>{if(1===a.readyState)try{const{serializer:e}=this._config;a.send(e(t))}catch(t){this.destination.error(t)}},t=>{const{closingObserver:e}=this._config;e&&e.next(void 0),t&&t.code?a.close(t.code,t.reason):c.error(new TypeError("WebSocketSubject.error must be called with an object with an error code, and an optional reason: { code: number, reason: string }")),this._resetState()},()=>{const{closingObserver:t}=this._config;t&&t.next(void 0),a.close(),this._resetState()}),o&&o instanceof i&&h.add(o.subscribe(this.destination))},a.onerror=t=>{this._resetState(),c.error(t)},a.onclose=t=>{this._resetState();const{closeObserver:e}=this._config;e&&e.next(t),t.wasClean?c.complete():c.error(t)},a.onmessage=t=>{try{const{deserializer:e}=this._config;c.next(e(t))}catch(t){c.error(t)}}}_subscribe(t){const{source:e}=this;return e?e.subscribe(t):(this._socket||this._connectSocket(),this._output.subscribe(t),t.add(()=>{const{_socket:t}=this;0===this._output.observers.length&&(t&&1===t.readyState&&t.close(),this._resetState())}),t)}unsubscribe(){const{_socket:t}=this;t&&1===t.readyState&&t.close(),this._resetState(),super.unsubscribe()}}t("WebSocketSubject",a)}}}));
